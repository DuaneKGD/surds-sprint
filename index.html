<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Surds Sprint â€” Duane Kamaragoda Tutoring</title>

  <!-- Inline SVG favicon (replace later if you want) -->
  <link rel="icon" href='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="256" height="256"><rect width="100%" height="100%" fill="%2323a559"/><text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" font-family="Arial" font-size="140" fill="white">âˆš</text></svg>'>

  <style>
    :root{
      --bg1:#ecfdf5;    /* mint gradient */
      --bg2:#f8fafc;
      --card:#ffffff;
      --ink:#0f172a;
      --muted:#475569;
      --brand:#22c55e;  /* green */
      --brand2:#10b981; /* teal green */
      --ok:#16a34a;
      --bad:#dc2626;
      --warn:#f59e0b;
      --shadow:0 12px 32px rgba(0,0,0,.10);
      --radius:20px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--ink);
      background:linear-gradient(180deg,var(--bg1) 0%,var(--bg2) 60%);
    }
    .container{max-width:980px;margin:0 auto;padding:20px}
    .hero{
      background:linear-gradient(135deg,var(--brand),var(--brand2));
      color:#fff; border-radius:26px; padding:22px; box-shadow:var(--shadow)
    }
    .hero h1{margin:0 0 8px; font-size:32px; letter-spacing:.2px}
    .hero p{margin:0; opacity:.92}
    .panel{margin-top:-14px; background:var(--card); border-radius:var(--radius); padding:16px; box-shadow:var(--shadow)}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .grow{flex:1}
    .stat{background:#eef2f7; padding:8px 12px; border-radius:12px; font-size:14px; white-space:nowrap}

    input,button,select{
      font:inherit; padding:12px 14px; border-radius:12px; border:1px solid #e2e8f0; outline:none; transition:.15s
    }
    input:focus,select:focus{box-shadow:0 0 0 6px rgba(34,197,94,.18); border-color:#86efac}
    button{border:0; background:#16a34a; color:#fff; cursor:pointer}
    button.secondary{background:#e5e7eb; color:#111}
    button.ghost{background:transparent; border:1px solid #cbd5e1; color:#111}
    button:disabled{opacity:.6; cursor:not-allowed}

    .startBig{
      background:linear-gradient(135deg,#16a34a,#22c55e);
      font-weight:800; font-size:18px; padding:14px 20px; border-radius:14px;
      box-shadow:0 10px 24px rgba(22,163,74,.25);
    }
    .card{background:var(--card); border-radius:var(--radius); padding:22px; box-shadow:var(--shadow); margin-top:16px}
    .question{
      font-size: clamp(32px, 6vw, 52px);
      font-weight: 900; letter-spacing:.4px; margin:6px 0 6px;
      animation: fadeIn .25s ease
    }
    .hint{color:#64748b; font-size:14px; margin-top:0}
    .feedback{min-height:28px; margin-top:10px}
    .ok{color:var(--ok)} .bad{color:var(--bad)} .warn{color:var(--warn)}
    .footer{color:#6b7280; font-size:12px; margin-top:18px; text-align:center}

    /* Timer bar with spark */
    .timerWrap{position:relative; background:#e2e8f0; border-radius:999px; overflow:hidden; height:16px}
    .timer{
      position:absolute; left:0; top:0; height:100%; width:100%;
      background:linear-gradient(90deg,#22c55e,#10b981); /* green initially */
      transition:width .25s linear, background .25s ease, box-shadow .25s ease
    }
    .timer.warn{ background:linear-gradient(90deg,#f59e0b,#fb923c);} /* orange */
    .timer.danger{ background:linear-gradient(90deg,#ef4444,#dc2626); box-shadow:0 0 12px rgba(239,68,68,.45); }
    @keyframes pulse { 0%{transform:scale(1)} 50%{transform:scale(1.02)} 100%{transform:scale(1)} }
    .timer.flash{ animation:pulse .6s ease 1; }
    .spark{
      position:absolute; top:50%; transform:translate(0,-50%);
      width:12px; height:12px; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #fff, #fde68a 35%, #f59e0b 70%, #f97316 100%);
      box-shadow:0 0 10px #f59e0b, 0 0 20px #fb923c;
      pointer-events:none;
    }

    /* Score popups */
    .floatScore{
      position:absolute; pointer-events:none; left:50%; transform:translateX(-50%);
      font-weight:900; font-size:30px; opacity:0; animation: floatUp .9s ease forwards
    }
    .floatScore.ok{ color:#22c55e; text-shadow:0 2px 6px rgba(34,197,94,.25) }
    .floatScore.bad{ color:#ef4444; text-shadow:0 2px 6px rgba(239,68,68,.25) }
    @keyframes floatUp{
      0%{ opacity:0; transform:translate(-50%, 10px) scale(.9); }
      10%{ opacity:1; transform:translate(-50%, 0) scale(1); }
      100%{ opacity:0; transform:translate(-50%, -40px) scale(1.05); }
    }

    .pop{ animation: pop .18s ease }
    @keyframes pop{ 0%{transform:scale(.98)} 100%{transform:scale(1)} }
    @keyframes fadeIn{ from{opacity:0; transform:translateY(4px)} to{opacity:1; transform:none} }

    /* Modal */
    .modal{
      position:fixed; inset:0; display:none; align-items:center; justify-content:center;
      background:rgba(15,23,42,.35); backdrop-filter:blur(3px); z-index:20
    }
    .modal.on{ display:flex }
    .modal .sheet{ background:#fff; border-radius:18px; box-shadow:var(--shadow); max-width:520px; width:92%; padding:22px }
    .sheet h3{ margin:0 0 8px } .sheet p{ margin:0 0 12px; color:#6b7280 }
    .madeby{ font-size:12px; color:#e2e8f0; margin-top:8px }
  </style>
</head>
<body>
  <div class="container">
    <header class="hero">
      <h1>Surds Sprint</h1>
      <p>Simplify and rationalise surds as quickly as you can in <strong>60 seconds</strong>.</p>
      <div class="madeby">Made by <strong>Duane Kamaragoda Tutoring</strong></div>
    </header>

    <section class="panel">
      <div class="row">
        <span class="stat">Player: <strong id="playerName">â€”</strong></span>
        <span class="stat">High score: <strong id="bestScore">0</strong></span>
        <span class="stat">Time left: <strong id="timeLeft">60</strong>s</span>
        <span class="stat">Score: <strong id="score">0</strong></span>

        <span class="grow"></span>

        <label class="stat">
          Mode:
          <select id="modeSelect">
            <option value="normal">Normal</option>
            <option value="hard">Hard</option>
          </select>
        </label>

        <button id="muteBtn" class="ghost" aria-pressed="false">ðŸ”Š Sound</button>
        <button id="changeNameBtn" class="ghost">Change name</button>
        <button id="startBtn" class="startBig">â–¶ Start</button>
        <button id="endBtn" class="secondary">End</button>
      </div>
      <div class="timerWrap" style="margin-top:12px; position:relative">
        <div id="timerBar" class="timer" style="width:100%"></div>
        <div id="spark" class="spark" style="left: 100%"></div>
      </div>
      <div class="hint" style="margin-top:8px;">
        Scoring: <span class="ok"><strong>+20</strong></span> correct, <span class="bad"><strong>â€“10</strong></span> wrong, <span class="warn"><strong>â€“5</strong></span> skip.
      </div>
    </section>

    <main class="card">
      <div class="question" id="question">Enter your name to begin.</div>
      <div class="hint">Answer in simplest surd form. You can type <code>sqrt</code> or use <code>âˆš</code>. Skipping has a small penalty.</div>
      <div class="row" style="margin-top:14px">
        <input id="answer" class="grow" placeholder="Type your answerâ€¦" autocomplete="off"/>
        <button id="submitBtn">Submit</button>
        <button id="skipBtn" class="secondary">Skip (âˆ’5)</button>
        <button id="resetBestBtn" class="ghost">Reset High Score</button>
      </div>
      <div id="feedback" class="feedback"></div>
      <div class="footer">Â© 2025 Duane Kamaragoda Tutoring â€” Progress is saved locally on this device (no accounts).</div>
    </main>
  </div>

  <!-- Name modal (required before starting) -->
  <div class="modal" id="nameModal" aria-modal="true" role="dialog">
    <div class="sheet">
      <h3>Welcome!</h3>
      <p>Enter your name so we can save your high score on this device.</p>
      <div class="row">
        <input id="nameInput" class="grow" placeholder="e.g., Duane"/>
        <button id="saveNameBtn">Save</button>
        <button id="cancelNameBtn" class="secondary">Cancel</button>
      </div>
      <p class="hint" style="margin-top:10px;">You must set a name before you can play.</p>
    </div>
  </div>

  <script>
    /* ========= CONFIG & KEYS ========= */
    const GAME_ID = 'surds-sprint-v4';
    const ROUND_SECONDS = 60;
    const KEY_NAME = `${GAME_ID}:name`;
    const KEY_BEST_NORMAL = `${GAME_ID}:best:normal`;
    const KEY_BEST_HARD   = `${GAME_ID}:best:hard`;

    const SCORE_CORRECT = 20;
    const SCORE_WRONG   = -10;
    const SCORE_SKIP    = -5; // half of wrong penalty

    /* ========= DOM ========= */
    const playerNameEl = document.getElementById('playerName');
    const bestScoreEl  = document.getElementById('bestScore');
    const timeLeftEl   = document.getElementById('timeLeft');
    const scoreEl      = document.getElementById('score');
    const questionEl   = document.getElementById('question');
    const answerEl     = document.getElementById('answer');
    const feedbackEl   = document.getElementById('feedback');

    const timerBar     = document.getElementById('timerBar');
    const spark        = document.getElementById('spark');

    const startBtn     = document.getElementById('startBtn');
    const endBtn       = document.getElementById('endBtn');
    const submitBtn    = document.getElementById('submitBtn');
    const skipBtn      = document.getElementById('skipBtn');
    const resetBestBtn = document.getElementById('resetBestBtn');
    const changeNameBtn= document.getElementById('changeNameBtn');
    const muteBtn      = document.getElementById('muteBtn');
    const modeSelect   = document.getElementById('modeSelect');

    const nameModal    = document.getElementById('nameModal');
    const nameInput    = document.getElementById('nameInput');
    const saveNameBtn  = document.getElementById('saveNameBtn');
    const cancelNameBtn= document.getElementById('cancelNameBtn');

    /* ========= STATE ========= */
    let running = false;
    let score = 0;
    let bestNormal = 0, bestHard = 0;
    let timeLeft = ROUND_SECONDS;
    let timerId = null;
    let currentQ = null;
    let deck = []; // shuffled, non-repeating for the active mode
    let lastDangerPulseAt = Infinity;
    let muted = false;
    let audioCtx = null;
    let beepInterval = null;

    /* ========= STORAGE ========= */
    const loadName = () => localStorage.getItem(KEY_NAME) || '';
    const saveName = n => localStorage.setItem(KEY_NAME, n);
    const loadBestNormal = () => Number(localStorage.getItem(KEY_BEST_NORMAL) || 0);
    const loadBestHard   = () => Number(localStorage.getItem(KEY_BEST_HARD) || 0);
    const saveBestNormal = v => localStorage.setItem(KEY_BEST_NORMAL, String(v));
    const saveBestHard   = v => localStorage.setItem(KEY_BEST_HARD, String(v));

    /* ========= AUDIO ========= */
    function ensureAudio(){
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }
    function beep(freq=880, dur=0.10, type='sine', gain=0.04){
      if (muted) return;
      ensureAudio();
      const osc = audioCtx.createOscillator();
      const g = audioCtx.createGain();
      osc.type = type;
      osc.frequency.value = freq;
      g.gain.value = gain;
      osc.connect(g); g.connect(audioCtx.destination);
      osc.start();
      setTimeout(()=>osc.stop(), dur*1000);
    }
    function chordOk(){
      if (muted) return;
      ensureAudio();
      beep(784,.10,'triangle',0.05);
      setTimeout(()=>beep(988,.10,'triangle',0.04), 70);
      setTimeout(()=>beep(1175,.10,'triangle',0.04),120);
    }
    function buzzBad(){
      if (muted) return;
      ensureAudio();
      beep(220,.12,'square',0.05);
      setTimeout(()=>beep(180,.12,'square',0.05),90);
    }
    function startBeepLoop(){
      stopBeepLoop();
      if (muted) return;
      ensureAudio();
      // Beep rate accelerates as timeLeft decreases
      const loop = ()=>{
        if (!running) return;
        let interval = 1000; // default 1s
        if (timeLeft <= 20 && timeLeft > 10) interval = 500;
        else if (timeLeft <= 10 && timeLeft > 5) interval = 350;
        else if (timeLeft <= 5) interval = 220;
        beep(700, 0.06, 'sine', 0.025);
        beepInterval = setTimeout(loop, interval);
      };
      loop();
    }
    function stopBeepLoop(){
      if (beepInterval){ clearTimeout(beepInterval); beepInterval = null; }
    }

    /* ========= UTILS ========= */
    function showModal(on=true){ nameModal.classList.toggle('on', on); if(on){ setTimeout(()=>nameInput.focus(),50);} }
    function currentMode(){ return modeSelect.value || 'normal'; }
    function renderHeader(){
      playerNameEl.textContent = loadName() || 'â€”';
      timeLeftEl.textContent   = timeLeft;
      scoreEl.textContent      = score;
      bestScoreEl.textContent  = currentMode()==='normal' ? bestNormal : bestHard;
    }
    function setTimerBar(){
      const pct = Math.max(0, Math.min(100, 100 * (timeLeft / ROUND_SECONDS)));
      timerBar.style.width = pct + '%';

      // spark at the bar edge
      const wrapWidth = document.querySelector('.timerWrap').clientWidth;
      const x = Math.max(8, Math.min(wrapWidth-8, (pct/100)*wrapWidth));
      spark.style.left = `${x - 6}px`;

      timerBar.classList.remove('warn','danger');
      if (pct <= 35 && pct > 15) timerBar.classList.add('warn');
      if (pct <= 15) {
        timerBar.classList.add('danger');
        if (timeLeft < lastDangerPulseAt - 3){
          timerBar.classList.add('flash');
          setTimeout(()=>timerBar.classList.remove('flash'), 600);
          lastDangerPulseAt = timeLeft;
        }
      }
    }
    function normalise(s){
      return s
        .replace(/\s+/g,'')
        .replace(/sqrt/gi,'âˆš')
        .replace(/\*/g,'')
        .toLowerCase();
    }
    function evalSurd(expr){
      try{
        let s = expr.replace(/\s+/g,'').replace(/âˆš/g,'Math.sqrt').replace(/(\d)(Math\.sqrt)/g,'$1*$2');
        if (s.includes('/')){
          const [num,den] = s.split('/');
          return (Function(`return (${num})/(${den})`))();
        }
        return (Function(`return (${s})`))();
      }catch{ return null; }
    }
    function approxEqual(aStr,bStr){
      const a = evalSurd(aStr), b = evalSurd(bStr);
      if (a==null || b==null) return false;
      return Math.abs(a-b) < 1e-6;
    }
    function animateScoreTo(target){
      const start = Number(scoreEl.textContent)||0;
      const diff = target - start;
      const dur = 300;
      const t0 = performance.now();
      function step(now){
        const p = Math.min(1, (now - t0)/dur);
        const eased = p<.5 ? 2*p*p : 1 - Math.pow(-2*p+2,2)/2;
        scoreEl.textContent = Math.round(start + diff*eased);
        if (p < 1) requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }
    function floatScore(text, ok=true){
      const el = document.createElement('div');
      el.className = 'floatScore ' + (ok ? 'ok':'bad');
      el.textContent = text;
      document.body.appendChild(el);
      const cardRect = document.querySelector('.card').getBoundingClientRect();
      el.style.top = (cardRect.top + 18) + 'px';
      setTimeout(()=> el.remove(), 1000);
    }

    /* ========= QUESTION BANKS ========= */
    const BANK_NORMAL = [
      // Simplify âˆšn (easy)
      ['Simplify âˆš8','2âˆš2'],['Simplify âˆš12','2âˆš3'],['Simplify âˆš18','3âˆš2'],['Simplify âˆš20','2âˆš5'],
      ['Simplify âˆš24','2âˆš6'],['Simplify âˆš27','3âˆš3'],['Simplify âˆš28','2âˆš7'],['Simplify âˆš32','4âˆš2'],
      ['Simplify âˆš45','3âˆš5'],['Simplify âˆš48','4âˆš3'],['Simplify âˆš50','5âˆš2'],['Simplify âˆš72','6âˆš2'],
      ['Simplify âˆš98','7âˆš2'],['Simplify âˆš75','5âˆš3'],['Simplify âˆš63','3âˆš7'],['Simplify âˆš80','4âˆš5'],
      // Like terms
      ['Simplify âˆš2 + âˆš2','2âˆš2'],['Simplify 2âˆš3 + âˆš3','3âˆš3'],['Simplify 3âˆš5 - âˆš5','2âˆš5'],
      ['Simplify 4âˆš2 - 3âˆš2','âˆš2'],['Simplify 5âˆš7 + 2âˆš7','7âˆš7'],['Simplify 6âˆš3 - 4âˆš3','2âˆš3'],
      ['Simplify âˆš6 + âˆš6 + âˆš6','3âˆš6'],['Simplify 2âˆš10 - âˆš10','âˆš10'],
      // Rationalise single âˆš
      ['Rationalise 1/âˆš2','âˆš2/2'],['Rationalise 1/âˆš3','âˆš3/3'],['Rationalise 1/âˆš5','âˆš5/5'],
      ['Rationalise 2/âˆš2','âˆš2'],['Rationalise 3/âˆš3','âˆš3'],['Rationalise âˆš3/âˆš3','1'],
    ].map(([p,a])=>({p,a}));

    const BANK_HARD = [
      // Bigger simplifications
      ['Simplify âˆš200','10âˆš2'],['Simplify âˆš300','10âˆš3'],['Simplify âˆš245','7âˆš5'],
      ['Simplify âˆš432','12âˆš3'],['Simplify âˆš500','10âˆš5'],
      // Combining with coefficients
      ['Simplify 2âˆš8 + 3âˆš8','5âˆš8'],['Simplify 4âˆš12 - 2âˆš12','2âˆš12'],['Simplify 3âˆš18 + âˆš8','3âˆš18+âˆš8â†’ (9âˆš2+2âˆš2)=11âˆš2','11âˆš2'],
      // (the previous line includes a guide; final canonical answer is the last element)
      // Rationalising harder (binomials)
      ['Rationalise 6/(âˆš5+âˆš2)','2(âˆš5-âˆš2)'],
      ['Rationalise 4/(âˆš3+âˆš3)','?','2/âˆš3'], // simplified: 4/(2âˆš3)=2/âˆš3 (could then rationalise to 2âˆš3/3)
      ['Rationalise 5/(âˆš7-âˆš2)','(5(âˆš7+âˆš2))/5','âˆš7+âˆš2'],
      // Mixed forms
      ['Simplify âˆš12 + âˆš27','2âˆš3+3âˆš3','5âˆš3'],
      ['Simplify 3âˆš2 + 5âˆš8','3âˆš2+10âˆš2','13âˆš2'],
      ['Simplify 4âˆš18 - âˆš8','12âˆš2-2âˆš2','10âˆš2'],
      // Squares/Products
      ['Simplify (âˆš3)^2','3'],['Simplify (2âˆš5)^2','20'],['Simplify âˆš2Â·âˆš8','âˆš16','4'],
      // A couple of rationalised single surd refreshers
      ['Rationalise 1/âˆš6','âˆš6/6'],['Rationalise 3/(2âˆš2)','3âˆš2/4'],
    ].map(arr=>{
      // support entries where we gave intermediate hints; canonical is last element
      const p = arr[0]; const a = arr[arr.length-1];
      return {p,a};
    });

    function shuffled(arr){
      const a = arr.slice();
      for (let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]] = [a[j],a[i]];
      }
      return a;
    }
    function makeDeck(mode){
      return shuffled(mode==='hard' ? BANK_HARD : BANK_NORMAL);
    }
    function nextQuestion(){
      if (deck.length === 0) deck = makeDeck(currentMode());
      currentQ = deck.pop();
      questionEl.textContent = currentQ.p;
      questionEl.classList.add('pop');
      setTimeout(()=>questionEl.classList.remove('pop'), 180);
      feedbackEl.textContent = '';
      answerEl.value = '';
      answerEl.focus();
    }

    /* ========= GAME FLOW ========= */
    function start(){
      if (running) return;
      if (!loadName()){ showModal(true); return; }
      running = true;
      score = 0;
      timeLeft = ROUND_SECONDS;
      lastDangerPulseAt = Infinity;
      timerBar.classList.remove('warn','danger','flash');
      deck = makeDeck(currentMode());
      nextQuestion();
      renderHeader();
      setTimerBar();
      // timer
      timerId = setInterval(()=>{
        timeLeft--;
        timeLeftEl.textContent = timeLeft;
        setTimerBar();
        if (timeLeft <= 0) end();
      },1000);
      // ticking beeps
      startBeepLoop();
    }

    function end(){
      if (!running) return;
      running = false;
      clearInterval(timerId); timerId = null;
      stopBeepLoop();

      const mode = currentMode();
      let isHigh = false;
      if (mode==='normal'){
        if (score > bestNormal){ bestNormal = score; saveBestNormal(bestNormal); isHigh = true; }
      } else {
        if (score > bestHard){ bestHard = score; saveBestHard(bestHard); isHigh = true; }
      }
      feedbackEl.innerHTML = `Time! Final score: <strong>${score}</strong>.` +
        (isHigh ? ` <span class="ok"><strong>New ${mode} high score!</strong></span>` : '');
      if (isHigh) chordOk();
      questionEl.textContent = 'Press Start to play again.';
      renderHeader();
    }

    function submit(){
      if (!running) return;
      const user = normalise(answerEl.value);
      const correct = normalise(currentQ.a);
      if (user === correct || approxEqual(user, correct)){
        const newScore = score + SCORE_CORRECT;
        floatScore('+'+SCORE_CORRECT, true); chordOk();
        animateScoreTo(newScore); score = newScore;
        nextQuestion();
        feedbackEl.innerHTML = `<span class="ok">Nice! Keep going.</span>`;
      } else {
        const newScore = Math.max(0, score + SCORE_WRONG);
        floatScore(String(SCORE_WRONG), false); buzzBad();
        animateScoreTo(newScore); score = newScore;
        feedbackEl.innerHTML = `<span class="bad">Not quite â€” try again or skip (âˆ’5).</span>`;
      }
    }

    function skip(){
      if (!running) return;
      const newScore = Math.max(0, score + SCORE_SKIP);
      floatScore(String(SCORE_SKIP), false);
      animateScoreTo(newScore); score = newScore;
      nextQuestion();
      feedbackEl.innerHTML = `<span class="warn">Skipped â€” small penalty. Keep going!</span>`;
    }

    /* ========= EVENTS ========= */
    startBtn.onclick = start;
    endBtn.onclick   = end;
    submitBtn.onclick= submit;
    skipBtn.onclick  = skip;
    resetBestBtn.onclick = ()=>{
      if (confirm('Reset high scores on this device for both modes?')){
        bestNormal = 0; bestHard = 0; saveBestNormal(0); saveBestHard(0); renderHeader();
      }
    };
    changeNameBtn.onclick = ()=> showModal(true);
    muteBtn.onclick = ()=>{
      muted = !muted;
      muteBtn.textContent = muted ? 'ðŸ”‡ Sound Off' : 'ðŸ”Š Sound';
      muteBtn.setAttribute('aria-pressed', String(!muted));
    };
    modeSelect.onchange = ()=> renderHeader();

    answerEl.addEventListener('keydown', e=>{
      if (e.key === 'Enter') submit();
    });

    saveNameBtn.onclick = ()=>{
      const n = nameInput.value.trim();
      if (!n){ alert('Please enter a name'); return; }
      saveName(n);
      showModal(false);
      renderHeader();
      answerEl.focus();
    };
    cancelNameBtn.onclick = ()=> showModal(false);

    /* ========= INIT ========= */
    (function init(){
      bestNormal = loadBestNormal();
      bestHard   = loadBestHard();
      renderHeader();

      // Force name entry if none set
      const n = loadName();
      if (!n){ showModal(true); }
      else { nameInput.value = n; }

      // keep best score display correct for current mode
      renderHeader();
    })();
  </script>
</body>
</html>
